<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ORCID OAuth Callback</title>
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; line-height: 1.4; }
    code, pre { background: #f6f8fa; padding: 0.2rem 0.35rem; border-radius: 6px; }
    pre { padding: 1rem; overflow: auto; }
    .ok { color: #0a7a0a; }
    .err { color: #b00020; }
    .muted { color: #666; }
  </style>
</head>
<body>
  <h1>ORCID OAuth Callback</h1>
  <p id="status" class="muted">Processing redirect…</p>

  <h2>Parameters</h2>
  <pre id="params">(none)</pre>

  <p class="muted">
    If you arrived here after authorizing an ORCID app, you can usually close this tab.
  </p>

  <script>
    // Display query parameters for debugging / confirmation.
    const params = new URLSearchParams(window.location.search);
    const obj = {};
    for (const [k, v] of params.entries()) obj[k] = v;

    const statusEl = document.getElementById("status");
    const paramsEl = document.getElementById("params");

    if (params.has("error")) {
      statusEl.textContent = `Error returned: ${params.get("error")}${params.get("error_description") ? " — " + params.get("error_description") : ""}`;
      statusEl.className = "err";
    } else if (params.has("code")) {
      statusEl.textContent = "Authorization code received successfully.";
      statusEl.className = "ok";
    } else {
      statusEl.textContent = "No OAuth parameters detected. This page is configured correctly, but was opened directly.";
      statusEl.className = "muted";
    }

    paramsEl.textContent = JSON.stringify(obj, null, 2);

    // Optional: store in sessionStorage for easy retrieval during debugging.
    // (Avoid localStorage because it persists longer than necessary.)
    try {
      sessionStorage.setItem("orcid_oauth_callback_params", JSON.stringify(obj));
    } catch (e) {}
  </script>
</body>
</html>
